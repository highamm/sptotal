<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fits a Separate Spatial Linear Model for Each Stratum — stratafit • sptotal</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fits a Separate Spatial Linear Model for Each Stratum — stratafit" />
<meta property="og:description" content="Estimates regression coefficients and spatial autocorrelation
parameters, given spatial coordinates, a model formula, and a
stratification variable. Arguments are the same here as they are
for slmfit(), with an extra argument for
stratacol, the name of the stratification column. Note that
stratum can either by incorporated as a covariate in
slmfit(), in which case the errors have the same
spatial covariance, or, models with differing spatial covariances
for the errors can be fit to each level of stratum, as is done here
in stratafit()." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sptotal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sptotal-vignette.html">Inference for Totals and Weighted Sums from Finite Spatial Populations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/highamm/sptotal/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fits a Separate Spatial Linear Model for Each Stratum</h1>
    <small class="dont-index">Source: <a href='https://github.com/highamm/sptotal/blob/master/R/stratafit.R'><code>R/stratafit.R</code></a></small>
    <div class="hidden name"><code>stratafit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimates regression coefficients and spatial autocorrelation
parameters, given spatial coordinates, a model formula, and a
stratification variable. Arguments are the same here as they are
for <code><a href='slmfit.html'>slmfit</a>()</code>, with an extra argument for
<code>stratacol</code>, the name of the stratification column. Note that
stratum can either by incorporated as a covariate in
<code><a href='slmfit.html'>slmfit</a>()</code>, in which case the errors have the same
spatial covariance, or, models with differing spatial covariances
for the errors can be fit to each level of stratum, as is done here
in <code>stratafit()</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>stratafit</span>(
  <span class='no'>formula</span>,
  <span class='no'>data</span>,
  <span class='no'>xcoordcol</span>,
  <span class='no'>ycoordcol</span>,
  <span class='kw'>stratacol</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>areacol</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>CorModel</span> <span class='kw'>=</span> <span class='st'>"Exponential"</span>,
  <span class='kw'>estmethod</span> <span class='kw'>=</span> <span class='st'>"REML"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>is an <code>R</code> linear model formula specifying the
response variable as well as covariates for predicting the response on the unsampled sites.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>is the data set with the response column, the covariates to
be used for the block kriging, and the spatial coordinates for all of the sites.</p></td>
    </tr>
    <tr>
      <th>xcoordcol</th>
      <td><p>is the name of the column in the data frame with x coordinates or longitudinal coordinates</p></td>
    </tr>
    <tr>
      <th>ycoordcol</th>
      <td><p>is the name of the column in the data frame with y coordinates or latitudinal coordinates</p></td>
    </tr>
    <tr>
      <th>stratacol</th>
      <td><p>is the name of the stratification column</p></td>
    </tr>
    <tr>
      <th>areacol</th>
      <td><p>is the name of the column with the areas of the sites. By default, we assume that all sites have equal area, in which
case a vector of 1's is used as the areas.</p></td>
    </tr>
    <tr>
      <th>CorModel</th>
      <td><p>is the covariance structure. By default, <code>CorModel</code> is
Exponential but other options include the Spherical and Gaussian.</p></td>
    </tr>
    <tr>
      <th>estmethod</th>
      <td><p>is either the default <code>"REML"</code> for restricted
maximum likelihood to estimate the covariance parameters and
regression coefficients or <code>"ML"</code> to estimate the covariance
parameters and regression coefficients.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of class <code>slmfit</code> with</p><ul>
<li><p>the spatial covariance estimates</p></li>
<li><p>the regression coefficient estimates</p></li>
<li><p>the covariance matrix of the fixed effects</p></li>
<li><p>minus two times the log-likeihood of the model</p></li>
<li><p>the names of the predictors</p></li>
<li><p>the sample size</p></li>
<li><p>the name of the covariance model used</p></li>
<li><p>a vector of residuals</p></li>
<li><p>the design matrix</p></li>
<li><p>a vector of the sampled densities</p></li>
<li><p>a list containing</p><ol>
<li><p>formula, the model formula</p></li>
<li><p>data, the data set input as the <code>data</code> argument</p></li>
<li><p>xcoordcol, the name of the x-coordinate column</p></li>
<li><p>ycoordcol, the name of the y-coordinate column</p></li>
<li><p>estmethod, either REML or ML</p></li>
<li><p>CorModel, the correlation model used</p></li>
<li><p>estimated covariance matrix of all sites</p></li>
<li><p>Inverted covariance matrix on the sampled sites</p></li>
<li><p>the vector of areas.</p></li>
</ol></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>exampledataset</span>) <span class='co'>## load a toy data set</span>
<span class='no'>exampledataset</span>$<span class='no'>strata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"A"</span>, <span class='fl'>19</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"B"</span>, <span class='fl'>21</span>))
<span class='no'>strataobj</span> <span class='kw'>&lt;-</span> <span class='fu'>stratafit</span>(<span class='kw'>formula</span> <span class='kw'>=</span> <span class='no'>counts</span> ~ <span class='no'>pred1</span> + <span class='no'>pred2</span>,
 <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>exampledataset</span>, <span class='kw'>stratacol</span> <span class='kw'>=</span> <span class='st'>"strata"</span>,
<span class='kw'>xcoordcol</span> <span class='kw'>=</span> <span class='st'>'xcoords'</span>, <span class='kw'>ycoordcol</span> <span class='kw'>=</span> <span class='st'>'ycoords'</span>, <span class='kw'>areacol</span> <span class='kw'>=</span> <span class='st'>'areavar'</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>strataobj</span>)</div><div class='output co'>#&gt; $A
#&gt; 
#&gt; Call:
#&gt; counts ~ pred1 + pred2
#&gt; 
#&gt; Residuals:
#&gt;     Min      1Q  Median      3Q     Max 
#&gt; -7.7826 -2.1499  0.0488  1.5492  9.8233 
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept)  22.2882     0.9936   22.43   &lt;2e-16 ***
#&gt; pred1        -6.5176     0.1030  -63.27   &lt;2e-16 ***
#&gt; pred2         0.5545     0.0509   10.89   &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Covariance Parameters:
#&gt;              Exponential Model
#&gt; Nugget                 20.0915
#&gt; Partial Sill         1227.2769
#&gt; Range                8575.6681
#&gt; 
#&gt; Generalized R-squared: 0.1998733 
#&gt; 
#&gt; $B
#&gt; 
#&gt; Call:
#&gt; counts ~ pred1 + pred2
#&gt; 
#&gt; Residuals:
#&gt;    Min     1Q Median     3Q    Max 
#&gt; -9.262 -4.974  1.516  3.355 14.635 
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept)  19.1464     0.4616  41.474   &lt;2e-16 ***
#&gt; pred1         1.4302     0.8103   1.765   0.0966 .  
#&gt; pred2        -1.6027     0.1964  -8.161   &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Covariance Parameters:
#&gt;              Exponential Model
#&gt; Nugget            4.188789e-05
#&gt; Partial Sill      4.205452e+01
#&gt; Range             4.954309e-01
#&gt; 
#&gt; Generalized R-squared: 0.09916644 
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Higham Matt, Ver Hoef Jay, Frank Bryce.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


